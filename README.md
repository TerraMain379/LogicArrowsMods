# OpenLogicArrows
**OpenLogicArrows** это мод *(расширение)*
для игры [logic arrows](https://logic-arrows.io/), позволяющий дополнять код игры!

## Внимание
**Проект находиться в стадии самого зарождения, буду очень рад вашей помощи!**

## Функции
Данный мод позволяет модифицировать почти любую функцию в исходном коде игры,
что позволяет не конфликтовать нескольким модам за общий файл.

## Как использовать?
Для использования функций **ModLoader**'а нужно в первую очередь
[создать своё браузерное расширение](https://habr.com/ru/articles/703330/),
или скопировать [этот пример](ExempleMod).

Теперь разберём 2 общих случая изменения и дополнения кода

#### Замена функции
``` js
GameManager.codeManager.setLocationAction("{локация}",function (args...) {
    //код, который заменет оригинальную функцию
})
```
#### Дополнение функции
``` js
GameManager.codeManager.addLocationAction("{локация}",function (args...) {
    //код, который выполнется перед тем, как выполниться оригинальная функция
})
```


В обоих на вход мы получаем аргументы оригинальной функции, а также,
ваш код будет выполнен через `.call()`, что означает,
что используя `this` вы будете обращаться к объекту, метод которого мы изменили.

Примечание: если вы заменили не метод, а функцию, то контекст сохраняться не будет!

### Локации
Как я сказал выше, чтобы изменить функцию / метод,
вам нужно указать локацию, но откуда её брать?

Для этого вы можете открыть [дополненный код игры](OpenLogicArrows/scripts/mapCode.js),
и в нём найти нужную вам функцию. Дальше вы смотрите, есть ли в начале её следующий код:
``` js
let N = dd("локация", .......); if (N[0]) return N[1];//:NDD
```
Если да, то скопируйте локацию, указанную в кавычках,
и используйте её в коде разобранном выше.
Если же вы столкнулись с тем, что такой строки нет, а вы хотите изменить эту функцию,
можете написать нам, или самостоятельно внести изменение, отправив их в этот репозиторий.
### Правила наименования локаций
Ниже я перечислю ситуации, и как в них нужно наименовать локацию.
Строки примеров из [этого файла](OpenLogicArrows/scripts/mapCode.js) будут указаны рядом в скобках.

Примечание: код игры начинается со следующего примера кода, до этого идёт код мода.
Если вы хотите модифицировать игру, то не трогайте этот код!
``` js
//до этого полностью код мода!

//а тут код игры
"use strict";
var e = {...
```

 - Методы классов, состоящих в модулях: `ИмяКласса.имяФункции` (58, 79 строка)

 - Конструкторы классов, состоящих в модулях: `ИмяКласса.constructor` (48, 88 строка)

 - Анонимные функции, инициализирующие модули: `номермодуля` (45, 135 строка)

#### Частные случаи
Для частных случаев, можете придумывать свои обозначения.

Пример: анонимная функция на 185 строке имеет локацию `691.f3`
 - `691` - номер модуля
 - `f3` - условный номер функции, т.к. в этом модуле очень много анонимных функций
### Оформление в коде
Внутри всех функций, которые возможно модифицировать, первой строкой должен идти следующий код:

`let N = dd("локация", this, e...); if (N[0]) return N[1];//:NDD`

Давайте его разберём!

```js
let N = // переменная, в которую мы поместим временные значения
    dd(// фунция из OpenLogicArrows, без неё не чё работать небудет
        "локация",// имя локации, читать подробнее выше
        this,// это контекст, указывается только если мы в методе. В иных случаях пишем null
        moduleLoaders,// здесь идут аргументы оригинальной функции
        loadedModules // их может быть сколько угодно, в зависимости от того, как выглядит оригинальный код
    ); //больше нам не придётся самим что-то менять, далее идёт готовый код.
if (N[0]) // это bool значние хранит в себе "должна ли функция после выполнения завершиться"
// true, если вы использовали "setLocationAction" и false, если "addLocationAction"
    return N[1];//это значние, которое вернул добавленный экшен,
// очивидно сработает только с "setLocationAction"
//:NDD // специальная метка, просто для удобства, чтобы можно было быстро найти нужные строки
```
### Как сделать свой вклад?
1. Не стесняйтесь и пишите свои идеи
2. Делайте вклад в этот репозиторий
3. Прочитайте всё что было выше, чтобы не тупить!

### Примечания
#### Несовместим с:
1. старыми версиями [Layers-DLC](https://github.com/Fotiska/Layers-DLC)
2. пока не придумал